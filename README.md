# Unsupervised CT Denoising with CycleGAN 
**[[üìù Report](https://drive.google.com/file/d/1oxQ0zbWGOuGPZ2Kt7D7ziQF5t8o_pcu1/view?usp=share_link)]**

This project involves the task of converting noisy input, specifically low-dose images, into high-dose images. The American Association of Physicists in Medicine (AAPM) dataset was utilized for CT image denoising tasks.

## Architectures
<div align="center">
    <img src="https://github.com/user-attachments/assets/5e10d7a6-e994-4a46-9c47-4646bfe2e119" alt="image" width="800">
</div>
<div align="center">
    <img src="https://github.com/user-attachments/assets/33e3e799-a46e-44b9-8548-38ef1f0c12c5" alt="image" width="600">
</div>

## Design the Loss
### Adversarial Loss ($L_{adv,F}$, $L_{adv,Q}$)
Measures the ability of discriminators ($D_F$, $D_Q$) to distinguish real images from fake images generated by the generator.
- $L_{adv,F} = \mathbb{E}{x_F} \left[ (D_F(x_F) - 1)^2 \right] + \mathbb{E}{x_Q} \left[ D_F(G_{Q2F}(x_Q))^2 \right]$
- $L_{adv,Q} = \mathbb{E}{x_Q} \left[ (D_Q(x_Q) - 1)^2 \right] + \mathbb{E}{x_F} \left[ D_Q(G_{F2Q}(x_F))^2 \right]$
  
Measures how well the generators ($G_{F2Q}$, $G_{Q2F}$) can fool the discriminators.
- $L_{adv,F} = \mathbb{E}{x_Q} \left[ (D_F(G_{Q2F}(x_Q)) - 1)^2 \right]$
- $L_{adv,Q} = \mathbb{E}{x_F} \left[ (D_Q(G_{F2Q}(x_F)) - 1)^2 \right]$

### Cycle Consistency Loss ($L_{cycle,F}$, $L_{cycle,Q}$)
Ensures that the two generators ($G_{F2Q}$, $G_{Q2F}$) are inverses of each other, preserving the original input after a cycle of transformations.
- $L_{cycle,F} = \mathbb{E}{x_F} \left[ \| G_{Q2F}(G_{F2Q}(x_F)) - x_F \|_1 \right]$
- $L_{cycle,Q} = \mathbb{E}{x_Q} \left[ \| G_{F2Q}(G_{Q2F}(x_Q)) - x_Q \|_1 \right]$

### Identity Loss ($L_{iden,F}$, $L_{iden,Q}$)
- $L_{iden,F} = \mathbb{E}{x_F} \left[ \| G_{Q2F}(x_F) - x_F \|_1 \right]$
- $L_{iden,Q} = \mathbb{E}{x_Q} \left[ \| G_{F2Q}(x_Q) - x_Q \|_1 \right]$

### Total Loss
$L_G = (L_{adv,F} + L_{adv,Q}) + \lambda_{cycle}(L_{cycle,F} + L_{cycle,Q}) + \lambda_{identity}(L_{iden,F} + L_{iden,Q}) = L_{adv} + \lambda_{cycle}L_{cycle} + \lambda_{identity}L_{identity}$





## Results
<div align="center">
    <img src="https://github.com/user-attachments/assets/61d6baf3-1b13-4731-b29d-6568fa8d806c" alt="image" width="600">
</div>
<div align="center">
    <img src="https://github.com/user-attachments/assets/ed01fd60-0976-45ba-a59d-525f91000114" alt="image" width="600">
</div>
<div align="center">
    <img src="https://github.com/user-attachments/assets/f5eaf3ff-7f6a-40f0-b70d-69961eeb0693" alt="image" width="500">
</div>
